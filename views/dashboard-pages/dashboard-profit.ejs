<!DOCTYPE html>
<!--=== Coding by CodingLab | www.codinglabweb.com === -->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap link -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
      integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
      crossorigin="anonymous"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />

    <!----======== CSS ======== -->
    <link rel="stylesheet" href="/style/dashboard-pages/dashboard-profit.css" />

    <!----===== Iconscout CSS ===== -->
    <link
      rel="stylesheet"
      href="https://unicons.iconscout.com/release/v4.0.0/css/line.css"
    />

    <title>Airbnb - Usuarios</title>

    <!--Airbnb icon-->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/sources/Airbnb icon.ico"
    />

    <!--Chart-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.0.1/chart.js"></script>
  </head>
  <body onload="buscar()">
    <nav>
      <div class="logo-image">
        <a href="./home"><img src="/sources/Airbnb icon navbar.png" /></a>
      </div>

      <div class="menu-items">
        <ul class="nav-links">
          <li>
            <a href="/dashboard-home">
              <i class="uil uil-estate"></i>
              <span class="link-name">Inicio</span>
            </a>
          </li>
          <li>
            <a href="/dashboard-profit">
              <i class="uil uil-credit-card"></i>
              <span class="link-name">Consultar usuarios</span>
            </a>
          </li>
          <li>
            <a href="/dashboard-booking">
              <i class="uil uil-chart"></i>
              <span class="link-name">Consultar pagos</span>
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <section class="dashboard">
      <div class="header-nav">
        <!--Navbar Title-->
        <span class="title_name">Panel de Usuarios</span>

        <ul class="navbar-nav ml-auto navbar_move">
          <li class="nav-item dropdown">
            <a
              class="nav-link menu_property"
              href="#"
              role="button"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <span class="material-symbols-outlined setting-menu">menu</span>
              <img
                class="rounded-circle image-nav"
                src="/sources/person-icon.png"
              />
            </a>

            <ul class="dropdown-menu dropdown_father">
              <li>
                <a class="dropdown-item dropdown_children" href="#"
                  >Administrador</a
                >
              </li>
              <hr class="change_line_navbar" />
              <li>
                <a class="dropdown-item dropdown_children" href="#"
                  >Cerrar Sesi&oacuten</a
                >
              </li>
            </ul>
          </li>
        </ul>
      </div>

      <div class="dash-content">
        <div class="activity">
          <div class="title">
            <i class="uil uil-user-check"></i>
            <span class="text">Usuarios</span>
          </div>
          <form action="/" method="GET">
            <input
              type="text"
              name="query"
              id="query"
              placeholder="Buscar por nombre o apellido"
              onkeyup="buscar()"
            />
          </form>
          <br />
          <table class="table table-striped" id="tabla-resultados">
            <thead>
              <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Correo</th>
                <th>Estado</th>
              </tr>
            </thead>

            <tbody id="table-body"></tbody>
          </table>
        </div>
      </div>
      <canvas id="graphics1" width="400" height="400"></canvas>
    </section>

    <!-- Link de Chart -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.0.1/chart.min.js"></script>
    <script>
      function buscar() {
        console.log("keyup");
        const query = document.getElementById("query").value;

        fetch(`/search-users?query=${query}`)
          .then((response) => response.json())
          .then((resultados) => {
            const tabla = document.getElementById("table-body");

            tabla.innerHTML = "";
            for (let i = 0; i < resultados.length; i++) {
              var isActive = "No Disponible";
              console.log(resultados[i]);
              if (resultados[i].active == "1") {
                isActive = "Disponible";
              }
              tabla.innerHTML += `
                    <tr>
                        <td>${resultados[i].id}</td>
                        <td>${resultados[i].name}</td>
                        <td>${resultados[i].lastname}</td>
                        <td>${resultados[i].email}</td>
                        <td>${isActive}</td>
                    </tr>
                    `;
            }
          });
      }
    </script>
  </body>
</html>
