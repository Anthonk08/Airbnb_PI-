<!-- Airbnb clone using Bootstrap 4 and Custom CSS -->

<!-- Bootstrap 4 is the newest version of Bootstrap, which is the most popular HTML, CSS, and JavaScript framework for developing responsive, mobile-first websites.

Bootstrap 4 is completely free to download and use! -->

<!-- What is Bootstrap?  -->

<!-- Bootstrap is a free front-end framework for faster and easier web development.

Bootstrap includes HTML and CSS based design templates for typography, forms, buttons, tables, navigation, modals, image carousels and many other, as well as optional JavaScript plugins.

Bootstrap also gives you the ability to easily create responsive designs. -->

<!DOCTYPE html>
<html>
   <head>

      <!-- The name between <title> tag defines the title of the document. -->
      <title>Registro de propiedad</title>

    <!-- Bootstrap 4 is designed to be responsive to mobile devices. Mobile-first styles are part of the core framework.

    To ensure proper rendering and touch zooming, add the following <meta> tag inside the <head> element: -->


      <meta name="viewport" content="width=device-width, initial-scale=1">

      <!-- Bootstrap link -->

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
      
      <!-- Font selection link -->

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

      <!-- The Styles used has been stored and saved in another file named "style.css" and linked through <link> tag as shown below: -->	
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css"
       integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14="
       crossorigin=""/>
      <link rel="stylesheet" href="/style/register-property.css">
      <script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js"
                                  integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg="
                                  crossorigin=""></script>
      <script src="/views/mapa.js"></script>
      <!--Airbnb icon-->
      <link rel="shortcut icon" type="image/x-icon" href="/sources/Airbnb icon.ico"/>
   </head>
   <body class="background_img">

         <!-- This is to display the Navbar of the website. -->

         <nav class="navbar navbar-expand-lg navbar-light">
            <div class="collapse navbar-collapse">

            <!-- SVG for Logo -->
            <a href="./home"><img src="/sources/Airbnb icon navbar.png" alt="" style="height: 50px; width: 100px;"></a>
            <!-- End of SVG -->
            <ul class="navbar-nav d-flex flex-row">
               <li class="nav-item"><a class="nav-link" href="./home">Inicio</a></li>
               <li class="nav-item"><a class="nav-link" href="#booking">Reservas</a></li>
               <li class="nav-item"><a class="nav-link" href="#contact">Contacto</a></li>
               <li class="nav-item"><a class="nav-link" href="#suggestions">Sugerencias</a></li>
               <li class="nav-item"><a class="nav-link" href="#aboutus">Sobre Nosotros</a></li>
            </ul>


            <ul class="navbar-nav ml-auto navbar_move">
               
               <li class="nav-item dropdown">
                  <a class="nav-link menu_property" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                     <span class="material-symbols-outlined setting-menu">menu</span>
                     <img class="rounded-circle" src="/sources/person-icon.png" alt="" style="width: 40px; height: 40px;">
                  </a>

                  <ul class="dropdown-menu dropdown_father">
                     <li><a class="dropdown-item dropdown_children" href="./">Iniciar Sesi&oacuten</a></li>
                     <li><a class="dropdown-item dropdown_children" href="./register">Registrarse</a></li>
                     <hr class="change_line_navbar">
                     <li><a class="dropdown-item dropdown_children" href="/messages-guest">Mensajes</a></li>
                     <li><a class="dropdown-item dropdown_children" href="/notification-guest">Notificaciones</a></li>
                     <li><a class="dropdown-item dropdown_children" href="/favorites-guest">Lista de Favoritos</a></li>
                     <hr class="change_line_navbar">
                     <li><a class="dropdown-item dropdown_children" href="/host-page">Anfitri&oacuten</a></li>
                     <hr class="change_line_navbar">
                     <li><a class="dropdown-item dropdown_children" href="#host">Recibe hu&eacutespedes</a></li>
                     <li><a class="dropdown-item dropdown_children" href="/account">Cuenta</a></li>
                     <hr class="change_line_navbar">
                     <li><a class="dropdown-item dropdown_children" href="/help">Ayuda</a></li>
                     <li><a class="dropdown-item dropdown_children" href="#">Cerrar Sesi&oacuten</a></li>
                  </ul>
               </li>
            </ul>

         </div>
      </nav>
         <hr class="change_line">

        <!-- End of NavBar -->

    <body>
        <div class="container">
            <div class="row">
                <div class="col-md-5 mx-auto">
                  <div id="first">
                     <div class="myform form">
                           <div class="logo mb-3">
                              <div class="col-md-12 text-center">
                                 <h1 align="center">Registrar Propiedad</h1>
                              </div>
                           </div>
                        <form action="/register-property" method="post" name="registro">
                           <label>Tipo de vivienda</label>
                           <select name="tipo_vivienda" id="tipo_vivienda" class="form-select" aria-label="Default select example">
                              <%if(livingTypes!=''){%>
                                 <% livingTypes.forEach(function(livingType){ %>
                                    <option value="<%=livingType.id%>"><%=livingType.description%></option>
                                 <%})%>
                              <%}%>
                             </select> 
                        
                              <p></p>
                             <div class="form-group">
                                <label>Ubicacion</label>
                                <!--<input type="text" class="form-control" id="search_input" placeholder="Escribe tu direccion"/>
                                <p></p>-->
                                <div id="map"></div>
                                <input type="text" name="loc" class="form-control" id="loc" hidden required>
                                <p></p>
                              <div class="form-group">
                                 <label>Direccion</label>
                                 <input type="text" name="address" class="form-control" id="address"required>
                                 <p></p>
                              </div>
                                <script>
                                    let map = L.map('map').setView([19.470800,-70.692039],8)
                                    var marker;

                                    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                       attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                                    }).addTo(map);

                                    // var marker = new L.marker([19.4792,-70.6931],{
                                    //    draggable: true,
                                    //    autoPan: true
                                    // }).addTo(map);
                                    
                                    // al hacer click
                                    function onMapClick(e) {
                                       if(marker!=undefined){

                                          map.removeLayer(marker);
                                       }
                                       //campo de las coordenadas
                                       document.getElementById('loc').value = e.latlng;
                                      
                                          // marcador al momento de dar click
                                       marker = new L.marker([e.latlng['lat'],e.latlng['lng']],{
                                          autoPan: true
                                       });
                                       map.addLayer(marker);
                                    }
                                    
                                    map.on('click', onMapClick);
                                </script>
                             </div>
                             <label for="cars">Provincia</label>

                             <select name="city" id="city" class="form-select" aria-label="Default select example"required>
                              <% cities.forEach(function(city){ %>
                                 <option value="<%=city.id_provincia%>"><%=city.provincia%></option>
                                 <%})%>
                             </select> 
                             <p></p>
                             <div class="form-group">
                                <label>Cantidad de personas</label>
                                <input type="number" name="persons" min="0" max="16" step="1" class="form-control" id="cant_personas" placeholder="1, 2, 3, ..."required>
                                <p></p>
                             </div>
                             <div class="form-group">
                                <label>Numero de camas</label>
                                <input type="number" name="beds" min="0" max="8" step="1" class="form-control" id="cant_camas" placeholder="1, 2, 3, ..."required>
                                <p></p>
                             </div>
                             <div class="form-group">
                                <label>Numero de habitaciones</label>
                                <input type="number" name="rooms" min="0" max="8" step="1" class="form-control" id="cant_hab" placeholder="1, 2, 3, ..."required>
                                <p></p>
                             </div>
                             <div class="form-group">
                                <label>Numero de baños</label>
                                <input type="number" name="baths" min="0" max="8" step="0.5 " class="form-control" id="cant_banos" placeholder="1, 1.5, 2, ..."required>
                                <p></p>
                             </div>
                             <div class="form-group">
                                <label>Fotos del lugar</label>
                                <input type="file" id="myFile" name="img" required>
                                <img id="image_view" style="display: block; width: 250px; height:250px">
                                <input type="hidden" id="source" name="source">
                                <p></p>
                              </div>
                             <div class="form-group">
                                <label>Precio por noche</label>
                                <input type="number" name="precio" min="0" max="100000" step="1" class="form-control" id="precio" placeholder="USD$86" required>
                                <p></p>
                             </div>
                              <!--<div class="form-group">
                                 <input type="checkbox" id="descuento" name="descuentoinicial" value="descuento">
                                 <label > Ofrecer un 20% de descuento a los 3 primeros huespedes.</label>
                                 <p></p>
                              </div>-->
                              <div class="col-md-12 text-center ">
                                 <button type="submit" class=" btn btn-block mybtn btn-primary tx-tfm">Registrar</button>
                              </div>
                        </form>
                     </div>
                  </div>
                </div>
            </div>
          </div>
          <hr>
          <div class="container" style="margin-top: 70px;">
            <div class="row">
               <div class="col-md-3">
                  <section>
                     <h6 style="margin-left: 40px;">Airbnb</h6>
                     <ul style="list-style: none;">
                        <li><a href="/help">Ayuda</a></li>
                        <li><a href="#">Pol&iacuteticas</a></li>
                        <li><a href="#">T&eacuterminos</a></li>
                        <li><a href="#">Privacidad</a></li>
                     </ul>
                  </section>
               </div>
               <div class="col-md-3">
                  <section>
                     <h6 style="margin-left: 40px;">Descubrir</h6>
                     <ul style="list-style: none;">
                        <li><a href="#">Confianza y seguridad</a></li>
                        <li><a href="#">Mapa del sitio</a></li>
                     </ul>
                  </section>
               </div>
               <div class="col-md-3">
                  <section>
                     <h6 style="margin-left: 40px;">Alojamiento</h6>
                     <ul style="list-style: none;">
                        <li><a href="#">Por qu&eacute anfitri&oacuten/a</a></li>
                        <li><a href="#">Alojamiento Responsable</a></li>
                        <li><a href="#">Casas abiertas</a>&emsp;<a href="#"><button type="button" class="btn btn-primary new">New</button></a></li>
                     </ul>
                  </section>
               </div>
               <div class="col-md-3">
                  <section>
                     <h5 style="margin-left: 40px;">
                     <a href="https://es-la.facebook.com/airbnb/" target="_blank" style="color: #3B5998;"><i class="fa fa-facebook" style="padding-right: 20px;"></i></a>
                     <a href="https://twitter.com/airbnb" target="_blank" style="color: #00ACEE;"><i class="fa fa-twitter" style="padding-right: 20px;"></i></a>
                     <a href="https://www.instagram.com/airbnb/" target="_blank" style="color: #d6249f;"><i class="fa fa-instagram" style="padding-right: 20px;"></i></a>
                     </h5>
                     <ul style="list-style: none;">
                        <li><a href="#">Reseñas</a></li>
                        <li><a href="#">Sugerencias</a></li>
                        <li><a href="#">Contacto</a></li>
                     </ul>
                  </section>
               </div>
            </div>
         </div>
          <!-- Proceso para guardar la imagen de la propiedad -->
          <script>
            var images = document.getElementById('myFile');
          
            images.onchange = () => {
               var image_file = images.files[0];

               var image_view = document.getElementById('image_view');
               
               var reader = new FileReader();
               

               reader.onload = (e) =>{
                  var canvas =document.createElement('canvas');

                  image_view.src = e.target.result;
                  
                  canvas.height = 500;
                  canvas.width = 500;
                  
                  var ctx = canvas.getContext('2d');

                  var img = new Image();
                  img.src = e.target.result;
                  
                  img.onload = function (){

                     ctx.drawImage(img,0,0,canvas.width,canvas.height);

                     var dataurl = canvas.toDataURL(image_file.type,0.7);
                     var src=document.getElementById('source');

                     src.value = dataurl;

                  }
               }
               reader.readAsDataURL(image_file);
            }
         
        
         </script>
         
<!-- 
         <script>
            console.log('hola');
         </script> -->
         <!-- Mostrar mensaje si esta definido -->
         <%if(message != undefined){%>
            <script>
                var message = '<%=message%>'; 
                alert(message);
               
            </script>
         <%}%>

        
    </body>

    

    <!--<style>
      #map{
         height:400px;
         width:100%;
      }
    </style>

    <script>
      var searchInput = 'search_input';

      $(document).ready(function() {
         var autocomplete;
         autocomplete = new google.maps.places.Autocomplete((document.getElementById(searchInput)), {
            types: ['geocode'],
         })

         google.maps.event.addListener(autocomplete, 'placed_changed', function() {
            var near_place = autocomplete.getPlace();
         })
      })

    </script>
    
   
    <script>
      function initMap(){
         var options = {
            zoom:8,
            center:{lat:19.470800,lng:-70.692039}
         }
         var map = new google.maps.Map(document.getElementById('map'), options);
      }
    </script>

    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDHsslCSYUI-iRV_i5LrAtIu0545GWd7GU&callback=initMap"
      defer
    ></script>-->

</html>